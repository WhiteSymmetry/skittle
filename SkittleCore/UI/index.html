<html>
<head>
	<title>WebSkittle Mockup</title>

	<link rel="stylesheet" type="text/css" href="{{STATIC_URL}}css/browser.css">
	<link rel="stylesheet" type="text/css" href="{{STATIC_URL}}css/popover.css">
	<style type="text/css">

	</style>

	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script src="{{STATIC_URL}}js/draw_canvas.js"></script>
	<script type="text/javascript">
  $(document).ready(function() {

  	$('#tools .radio-tools').click(function() {
  		$('#tools .radio-tools').removeClass('active');
  		$(this).addClass('active');
  		if ($(this).attr('data-tool')) activeTool = $(this).attr('data-tool')
  	})

  	$('#link-here').click(function() {
  		var offset = $(this).offset();
  		$(this).toggleClass('active');
  		var currentURL = "http://dnaskittle.com/genome-name/?=start=609&width=76&scale=1&zoom=1&graphs=nuc-dis,nuc-bias,r-map"
  		if (typeof linkPopover === "undefined") {
  			linkPopover = $('<div class="popover"></div>');
  			$('body').append(linkPopover);
  		}
  		else {
  			linkPopover.toggle();
  		}
  		linkPopover.offset({ top: (offset.top - 10), left: (offset.left + $(this).outerWidth() + 16) })
  		linkPopover.html('Copy this link: <br>' + currentURL);
  	})
  	$('#dials span').click(function() {
  		var targetFunction = $(this).attr('data-fn')
  		var offset = $(this).position();
  		var inputBox = $('<input type="text">');
  		$(this).parent().append(inputBox.offset(offset).val($(this).html()));
  		inputBox.select();
  		// inputBox.val().split(' ')[0].select();
  		inputBox.blur(function() {
  			if(targetFunction) eval(targetFunction + '("' + this.value + '")')
  			$(this).remove();
  		})
  	})
  	$("#buttonGraphs").click(function(){
  		$("#graphList").toggleClass('active')
  		setTimeout(function() {
  		  $("#graphList").removeClass('active');
  		}, 1500);
  	})

  });

	</script>
</head>
<body>
	<h1 id="logo"><img src="{{STATIC_URL}}gfx/skittle-logo3.png"><span>DNA</span>Skittle</h1>
	
	<div id="canvasContainer">
	    <canvas id="c" width="2000" height="1000"></canvas>
		<div id="graph-labels">
			<ul>
				<li id="graphLabel-a" style="width:159px;">Annotations <img src="{{STATIC_URL}}gfx/icons/close.png" class="closeGraphButton"></li>
				<li id="graphLabel-c" style="width:76px;">Alignment Cylinder <img src="{{STATIC_URL}}gfx/icons/close.png" class="closeGraphButton"></li>
				<li id="graphLabel-n" style="width:320px;display:block;" class="widthBased">Nucleotide Display <img src="{{STATIC_URL}}gfx/icons/close.png" class="closeGraphButton"></li>
				<li id="graphLabel-b" style="width:410px;">Nucleotide Bias <img src="{{STATIC_URL}}gfx/icons/close.png" class="closeGraphButton"></li>
				<li id="graphLabel-m" style="width:640px;">Repeat Map <img src="{{STATIC_URL}}gfx/icons/close.png" class="closeGraphButton"></li>
			</ul>
		</div>
	</div>
	<header>
		<ul>
			<li>Discover</li>
			<li>Share</li>
			<li>Learn</li>
		</ul>
		<p><img src="{{STATIC_URL}}gfx/twitter-bird-dark-bgs.png" height="36" width="36"><img src="{{STATIC_URL}}gfx/github-white.png" height="22"></p>
	</header>
	<div id="tools">
		<ul>
			<li class="" id="buttonGraphs"><img src="{{STATIC_URL}}gfx/icons/67.png" width="20" height="20">Graphs</li>
			<li class="radio-tools active" data-tool="Move"><img src="{{STATIC_URL}}gfx/icons/41.png" width="20" height="20">Move</li>
			<li class="radio-tools" data-tool="Select"><img src="{{STATIC_URL}}gfx/icons/dialog.png" width="20" height="20">Select</li>
			<li class="radio-tools" data-tool="Find"><img src="{{STATIC_URL}}gfx/icons/7.png" width="20" height="20">Find</li>
			<li class="radio-tools" data-tool="Annotate"><img src="{{STATIC_URL}}gfx/icons/39.png" width="20" height="20">Annotate</li>
			<li id="link-here"><img src="{{STATIC_URL}}gfx/icons/flag.png" width="20" height="20">Link Here</li>
			<li><img src="{{STATIC_URL}}gfx/icons/camera.png" width="20" height="20">Screenshot</li>
			<li class="bottom"><img src="{{STATIC_URL}}gfx/icons/cog.png" width="20" height="20">Settings</li>
		</ul>
	</div>
	<div id="dials">
		<ul>
			<li>Width: <span id="widthDisplay" data-fn="UIwidthChange">100 bp</span>
				<div id="widthBubble" class="popover arrow-bottom-center">
					<div class="button" onClick="doubleWidth()">x2</div>
					<div class="button" onClick="halfWidth()">/2</div>
				</div>
			</li>
			<li>Scale: <span id="scaleDisplay">1 bp/pixel</span>
				<div id="scaleBubble" class="popover arrow-bottom-center">
					<div class="button" onClick="setStartTo(1)">1:1</div>
					<div class="button" onClick="goToEnd()">Whole File</div>
				</div>
			</li>
			<li>Start Index: <span id="startDisplay" data-fn="UIstartChange">1</span>
				<div id="startBubble" class="popover arrow-bottom-center">
					<div class="button" onClick="setStartTo(1)">Top</div>
					<div class="button" onClick="goToEnd()">End</div>
				</div>
			</li>
			<li>End Index: <span id="endDisplay" data-fn="UIendChange">23865</span></li>
		</ul>
	</div>


	<div class="popover arrow-left-top" id="graphList">
		<ul>
			<li><input type="checkbox" id="showGraph-a" name="showGraphA"><label for="showGraphA">Annotations</label></li>
			<li><input type="checkbox" id="showGraph-n" name="showGraphND" checked="checked"><label for="showGraphND">Nucleotide Display</label></li>
			<li><input type="checkbox" id="showGraph-b" name="showGraphNB"><label for="showGraphA">Nucleotide Bias</label></li>
			<li><input type="checkbox" id="showGraph-m" name="showGraphRM"><label for="showGraphRM">Repeat Map</label></li>
		</ul>
	</div>


	<script type="text/javascript">
    var cc, c, b;
    var isDrag = false;
    var dragWidth = false;
    var activeTool = 'Move';
    
    // initial values
    start = 1;
    width = 100;
    scale = 1;
    zoom  = 1;

    var nd_url = '{{STATIC_URL}}chrY3.png'
    var rm_url = '{{STATIC_URL}}chrY-rmap.png';

	$(document).ready(function() {

		cc = document.getElementById('c') //visible canvas - scale will be 3*zoom
		c = cc.getContext("2d");
	    var bb = document.createElement('canvas'); //scratch canvas
	    bb.height = 500
	    bb.width = 5000
	    b = bb.getContext("2d");


	    init();

	    document.onkeydown = keyListener; 
	    
	    cc.onselectstart = function () { return false; } //fixes a problem where double clicking causes text to get selected on the canvas
	    cc.onmousedown = mouseDown;
	    cc.onmousemove = mouseMove;
	    cc.onmouseup = mouseUp;
	    cc.onmousewheel = mouseWheel;

	})
	</script>

</body>
</html>